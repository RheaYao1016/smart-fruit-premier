import{u as I}from"./production-DYp3C4TN.js";import{x as B,f as y,y as z,o as p,c as x,a as t,t as i,F as T,r as V,z as $,e as l,A as M,j,m as P,i as w,n as D,p as F,s as N,g as A,u as E,d as G,_ as L,B as R,C as U,q as O}from"./index-CRnHf-Cy.js";import{_ as W}from"./ImageField-bbXNBN96.js";import"./ImageEditor-BPxq-xw8.js";/**
 * @license lucide-vue-next v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=B("ImageIcon",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),H={class:"space-y-4"},J={class:"card p-4"},K={class:"mt-4 flex items-center justify-center gap-4"},Q={class:"rounded-2xl bg-amber-50 px-5 py-2 text-2xl font-bold text-amber-600"},X={class:"grid grid-cols-3 gap-2"},Y=["src"],Z={__name:"Step1Placement",emits:["next"],setup(C,{emit:u}){const v=u,n=I(),s=y(n.draft.fruitCount);z(s,f=>{const m=Math.max(1,Math.min(6,Number(f||1)));m!==f&&(s.value=m)});function a(){s.value=Math.max(1,s.value-1)}function o(){s.value=Math.min(6,s.value+1)}function r(){n.setFruitCount(s.value),v("next")}return(f,m)=>(p(),x("div",H,[t("div",J,[m[0]||(m[0]=t("h2",{class:"text-lg font-semibold"},"步骤1：水果安放",-1)),m[1]||(m[1]=t("p",{class:"mt-1 text-sm text-stone-500"},"请先放置水果，再确认数量（1-6个）。",-1)),t("div",K,[t("button",{class:"h-10 w-10 rounded-full bg-stone-100 text-xl",onClick:a},"-"),t("div",Q,i(s.value),1),t("button",{class:"h-10 w-10 rounded-full bg-stone-100 text-xl",onClick:o},"+")])]),t("div",X,[(p(),x(T,null,V(6,g=>t("div",{key:g,class:$(["overflow-hidden rounded-xl border",g<=s.value?"border-amber-300 bg-amber-50":"border-stone-200 bg-stone-100 opacity-50"])},[t("img",{src:l(M).fruits[(g-1)%l(M).fruits.length],class:"h-20 w-full object-cover"},null,8,Y)],2)),64))]),t("button",{class:"w-full rounded-xl bg-amber-500 px-4 py-3 font-semibold text-white",onClick:r},"继续：水果预处理")]))}},tt={class:"space-y-4"},et={class:"space-y-3"},st={class:"mb-3 text-sm font-medium"},nt={class:"grid grid-cols-3 gap-2 text-sm"},ot=["onClick"],rt=["onClick"],at={class:"grid grid-cols-2 gap-2"},lt={__name:"Step2Preprocess",emits:["next","back"],setup(C,{emit:u}){const v=u,n=I();function s(a,o){const r=n.draft.fruits[a];!r||o==="cutting"||n.updateFruit(a,{[o]:!r[o]})}return(a,o)=>(p(),x("div",tt,[o[3]||(o[3]=t("div",{class:"card p-4"},[t("h2",{class:"text-lg font-semibold"},"步骤2：水果预处理"),t("p",{class:"mt-1 text-sm text-stone-500"},"去核/削皮可选；切块必选且不可取消。")],-1)),t("div",et,[(p(!0),x(T,null,V(l(n).draft.fruits,(r,f)=>(p(),x("div",{key:r.id,class:"card p-4"},[t("p",st,"水果 "+i(r.id),1),t("div",nt,[t("button",{class:$(["rounded-xl border px-2 py-2",r.pitting?"border-amber-400 bg-amber-50 text-amber-700":"border-stone-200"]),onClick:m=>s(f,"pitting")}," 去核 "+i(r.pitting?"✓":""),11,ot),t("button",{class:$(["rounded-xl border px-2 py-2",r.peeling?"border-amber-400 bg-amber-50 text-amber-700":"border-stone-200"]),onClick:m=>s(f,"peeling")}," 削皮 "+i(r.peeling?"✓":""),11,rt),o[2]||(o[2]=t("div",{class:"rounded-xl border border-emerald-300 bg-emerald-50 px-2 py-2 text-center text-emerald-700"}," 切块 ✓ ",-1))])]))),128))]),t("div",at,[t("button",{class:"rounded-xl border border-stone-300 px-4 py-3",onClick:o[0]||(o[0]=r=>v("back"))},"上一步"),t("button",{class:"rounded-xl bg-amber-500 px-4 py-3 font-semibold text-white",onClick:o[1]||(o[1]=r=>v("next"))},"继续：处理方案")])]))}},dt={class:"space-y-4"},it={key:0,class:"grid grid-cols-1 gap-3"},ut={key:1,class:"card space-y-3 p-4"},ct={class:"font-medium"},pt=["src"],xt={class:"rounded-xl border border-amber-200 bg-amber-50/50 p-2"},mt={class:"mb-2 inline-flex items-center gap-2 text-sm font-medium text-amber-700"},bt=["src"],vt={class:"grid grid-cols-2 gap-2"},ft={key:2,class:"space-y-3"},gt={key:0,class:"card space-y-3 p-4"},_t={class:"grid grid-cols-3 gap-2"},yt=["onClick"],wt=["value"],$t={class:"mt-1 text-xs text-stone-600"},kt={class:"grid grid-cols-2 gap-2"},ht=["value"],Ct={class:"mt-1 text-xs text-stone-600"},St={key:1,class:"card space-y-3 p-4"},Mt=["value"],It={class:"mt-1 text-xs text-stone-600"},Tt=["value"],Vt={class:"mt-1 text-xs text-stone-600"},jt={class:"grid grid-cols-2 gap-2"},Nt={__name:"Step3Scheme",emits:["next","back"],setup(C,{emit:u}){const v=u,n=I(),s=y(n.draft.mode?"blade":"mode"),a=y(n.draft.mode||"juice"),o=y(!1),r=w(()=>a.value==="juice"?"果汁":a.value==="canned"?"罐头":"果切"),f=w(()=>{var e;const h=(e=M.bladeGuides)==null?void 0:e[a.value];return(h==null?void 0:h.url)||"/刀片图1.png"}),m=w(()=>o.value?M.bladeImages[a.value]:f.value),g=["冷饮","常温","热饮"],k=["细腻无渣","微渣口感","高纤维"];function d(h){a.value=h,s.value="blade",o.value=!1}function b(){if(n.setMode(a.value),a.value==="cut"){v("next");return}s.value="settings"}function _(){v("next")}function S(){o.value=!0}return(h,e)=>(p(),x("div",dt,[e[25]||(e[25]=t("div",{class:"card p-4"},[t("h2",{class:"text-lg font-semibold"},"步骤3：处理方案选择"),t("p",{class:"mt-1 text-sm text-stone-500"},"果汁 / 罐头 / 果切")],-1)),s.value==="mode"?(p(),x("section",it,[t("button",{class:"card p-4 text-left",onClick:e[0]||(e[0]=c=>d("juice"))},[...e[12]||(e[12]=[t("p",{class:"text-base font-semibold"},"果汁",-1),t("p",{class:"text-xs text-stone-500"},"支持滤网口感、温度、甜度配置",-1)])]),t("button",{class:"card p-4 text-left",onClick:e[1]||(e[1]=c=>d("canned"))},[...e[13]||(e[13]=[t("p",{class:"text-base font-semibold"},"罐头",-1),t("p",{class:"text-xs text-stone-500"},"支持温度和甜度配置",-1)])]),t("button",{class:"card p-4 text-left",onClick:e[2]||(e[2]=c=>d("cut"))},[...e[14]||(e[14]=[t("p",{class:"text-base font-semibold"},"果切",-1),t("p",{class:"text-xs text-stone-500"},"完成刀头检查后可直接制作",-1)])])])):s.value==="blade"?(p(),x("section",ut,[t("p",ct,"刀头检查（"+i(r.value)+"）",1),t("img",{src:l(M).bladeImages[a.value],class:"h-44 w-full rounded-xl object-cover"},null,8,pt),t("div",xt,[t("div",mt,[j(l(q),{class:"h-4 w-4"}),e[15]||(e[15]=P(" 刀片示意图 ",-1))]),t("img",{src:m.value,class:"h-32 w-full rounded-lg object-cover",onError:S},null,40,bt),e[16]||(e[16]=t("div",{class:"mt-2 rounded-lg bg-white/80 px-3 py-2 text-xs leading-5 text-stone-600"},[t("p",null,"1. 确认刀片卡槽方向与示意图一致。"),t("p",null,"2. 刀片边缘无裂痕、无明显磨损。"),t("p",null,"3. 旋紧锁扣后再继续下一步。")],-1))]),t("div",vt,[t("button",{class:"rounded-xl border border-stone-300 px-4 py-2",onClick:e[3]||(e[3]=c=>s.value="mode")},"重新选方案"),t("button",{class:"rounded-xl bg-amber-500 px-4 py-2 font-semibold text-white",onClick:b},"已检查完成")])])):(p(),x("section",ft,[a.value==="juice"?(p(),x("div",gt,[e[21]||(e[21]=t("p",{class:"font-medium"},"果汁参数",-1)),t("div",null,[e[17]||(e[17]=t("p",{class:"mb-2 text-xs text-stone-500"},"滤网口感",-1)),t("div",_t,[(p(),x(T,null,V(k,c=>t("button",{key:c,class:$(["rounded-xl border px-2 py-2 text-xs",l(n).draft.settings.texture===c?"border-amber-400 bg-amber-50 text-amber-700":"border-stone-200"]),onClick:de=>l(n).updateSettings({texture:c})},i(c),11,yt)),64))])]),t("div",null,[e[18]||(e[18]=t("p",{class:"mb-2 text-xs text-stone-500"},"温度",-1)),t("input",{type:"range",min:"0",max:"2",step:"1",value:g.indexOf(l(n).draft.settings.temperature),class:"w-full accent-amber-500",onInput:e[4]||(e[4]=c=>l(n).updateSettings({temperature:g[Number(c.target.value)]}))},null,40,wt),t("p",$t,"当前："+i(l(n).draft.settings.temperature),1)]),t("div",null,[e[19]||(e[19]=t("p",{class:"mb-2 text-xs text-stone-500"},"甜度",-1)),t("div",kt,[t("button",{class:$(["rounded-xl border px-2 py-2 text-xs",l(n).draft.settings.sweetnessType==="自定义"?"border-amber-400 bg-amber-50 text-amber-700":"border-stone-200"]),onClick:e[5]||(e[5]=c=>l(n).updateSettings({sweetnessType:"自定义"}))},"自定义",2),t("button",{class:$(["rounded-xl border px-2 py-2 text-xs",l(n).draft.settings.sweetnessType==="健康推荐"?"border-amber-400 bg-amber-50 text-amber-700":"border-stone-200"]),onClick:e[6]||(e[6]=c=>l(n).updateSettings({sweetnessType:"健康推荐",sweetnessValue:20}))},"健康推荐",2)]),t("input",{type:"range",min:"0",max:"100",step:"1",class:"mt-2 w-full accent-amber-500",value:l(n).draft.settings.sweetnessValue,onInput:e[7]||(e[7]=c=>l(n).updateSettings({sweetnessValue:Number(c.target.value)}))},null,40,ht),t("p",Ct,"甜度："+i(l(n).draft.settings.sweetnessValue)+"%",1),e[20]||(e[20]=t("p",{class:"text-xs text-emerald-600"},"建议：低糖用户可控制在 0~30%。",-1))])])):(p(),x("div",St,[e[24]||(e[24]=t("p",{class:"font-medium"},"罐头参数",-1)),t("div",null,[e[22]||(e[22]=t("p",{class:"mb-2 text-xs text-stone-500"},"温度",-1)),t("input",{type:"range",min:"0",max:"2",step:"1",value:g.indexOf(l(n).draft.settings.cannedTemperature),class:"w-full accent-amber-500",onInput:e[8]||(e[8]=c=>l(n).updateSettings({cannedTemperature:g[Number(c.target.value)]}))},null,40,Mt),t("p",It,"当前："+i(l(n).draft.settings.cannedTemperature),1)]),t("div",null,[e[23]||(e[23]=t("p",{class:"mb-2 text-xs text-stone-500"},"甜度",-1)),t("input",{type:"range",min:"0",max:"100",step:"1",value:l(n).draft.settings.cannedSweetness,class:"w-full accent-amber-500",onInput:e[9]||(e[9]=c=>l(n).updateSettings({cannedSweetness:Number(c.target.value)}))},null,40,Tt),t("p",Vt,"当前："+i(l(n).draft.settings.cannedSweetness)+"%",1)])])),t("div",jt,[t("button",{class:"rounded-xl border border-stone-300 px-4 py-3",onClick:e[10]||(e[10]=c=>s.value="blade")},"返回刀头检查"),t("button",{class:"rounded-xl bg-amber-500 px-4 py-3 font-semibold text-white",onClick:_},"继续：制作监控")])])),t("button",{class:"w-full rounded-xl border border-stone-300 px-4 py-2",onClick:e[11]||(e[11]=c=>v("back"))},"返回上一步")]))}},Bt={class:"space-y-4"},zt={class:"card p-4"},Pt={class:"mb-2 flex items-center justify-between text-sm"},Dt={class:"font-semibold text-amber-600"},Ft={class:"h-3 overflow-hidden rounded-full bg-stone-100"},At={class:"mt-2 text-xs text-stone-500"},Et={class:"card p-4"},Gt={class:"grid grid-cols-3 gap-2 text-sm"},Lt={class:"grid grid-cols-2 gap-2"},Rt=["disabled"],Ut={__name:"Step4Monitor",emits:["next","back"],setup(C,{emit:u}){const v=u,n=I(),s=y(0),a=y(!1),o=y([]);let r=null;const f=w(()=>Math.max(8e3,n.draft.fruitCount*3500)),m=w(()=>Math.max(0,Math.round(f.value*(1-s.value/100)/1e3)));function g(){const d=100/(f.value/200);r=window.setInterval(()=>{s.value=Math.min(100,s.value+d);const b=Math.floor(s.value/100*n.draft.fruitCount);o.value=Array.from({length:b},(_,S)=>S+1),s.value>=100&&(a.value=!0,window.clearInterval(r),r=null)},200)}return D(()=>{g()}),F(()=>{r&&window.clearInterval(r)}),(k,d)=>(p(),x("div",Bt,[d[4]||(d[4]=t("div",{class:"card p-4"},[t("h2",{class:"text-lg font-semibold"},"步骤4：制作与监控"),t("p",{class:"mt-1 text-sm text-stone-500"},"正在按设定参数处理水果。")],-1)),t("div",zt,[t("div",Pt,[d[2]||(d[2]=t("span",null,"当前进度",-1)),t("span",Dt,i(Math.round(s.value))+"%",1)]),t("div",Ft,[t("div",{class:"h-full bg-amber-500 transition-all",style:N({width:`${s.value}%`})},null,4)]),t("p",At,"预计剩余 "+i(m.value)+" 秒",1)]),t("div",Et,[d[3]||(d[3]=t("p",{class:"mb-2 text-sm font-medium"},"水果完成状态",-1)),t("div",Gt,[(p(!0),x(T,null,V(l(n).draft.fruitCount,b=>(p(),x("div",{key:b,class:$(["rounded-xl border px-2 py-2 text-center",o.value.includes(b)?"border-emerald-300 bg-emerald-50 text-emerald-700":"border-stone-200 text-stone-500"])},i(o.value.includes(b)?"已完成":"处理中")+" #"+i(b),3))),128))])]),t("div",Lt,[t("button",{class:"rounded-xl border border-stone-300 px-4 py-3",onClick:d[0]||(d[0]=b=>v("back"))},"上一步"),t("button",{class:$(["rounded-xl px-4 py-3 font-semibold text-white",a.value?"bg-amber-500":"bg-stone-300"]),disabled:!a.value,onClick:d[1]||(d[1]=b=>v("next"))},i(a.value?"继续：完成提示":"制作中..."),11,Rt)])]))}},Ot={class:"space-y-4"},Wt={class:"card p-4"},qt={class:"mt-1 text-sm text-stone-500"},Ht={class:"card p-4"},Jt={class:"whitespace-pre-wrap rounded-xl bg-stone-50 p-3 text-xs text-stone-600"},Kt={class:"grid grid-cols-1 gap-2"},Qt={key:0,class:"rounded-xl bg-green-50 px-3 py-2 text-xs text-green-600"},Xt={__name:"Step5Complete",emits:["restart"],setup(C,{emit:u}){const v=u,n=A(),s=I(),a=E(),o=y(!1),r=y(""),f=w(()=>s.draft.mode==="juice"?"果汁":s.draft.mode==="canned"?"罐头":s.draft.mode==="cut"?"果切":"-"),m=w(()=>s.draft.mode==="juice"?{texture:s.draft.settings.texture,temperature:s.draft.settings.temperature,sweetnessType:s.draft.settings.sweetnessType,sweetnessValue:s.draft.settings.sweetnessValue}:s.draft.mode==="canned"?{temperature:s.draft.settings.cannedTemperature,sweetnessValue:s.draft.settings.cannedSweetness}:{bladeChecked:!0});function g(){var b;(b=a.currentUser)!=null&&b.id&&(s.addHistoryRecord({userId:a.currentUser.id,mode:s.draft.mode,fruitCount:s.draft.fruitCount,preprocess:s.draft.fruits,params:m.value,image:r.value||""}),o.value=!0)}function k(){s.resetDraft(),r.value="",o.value=!1,v("restart")}function d(){s.resetDraft(),n.push("/my")}return(b,_)=>(p(),x("div",Ot,[t("div",Wt,[_[1]||(_[1]=t("h2",{class:"text-lg font-semibold text-emerald-700"},"步骤5：制作完成",-1)),t("p",qt,"本次模式："+i(f.value)+"，水果数量："+i(l(s).draft.fruitCount)+"。",1)]),t("div",Ht,[_[2]||(_[2]=t("p",{class:"mb-2 text-sm font-medium"},"参数回顾",-1)),t("pre",Jt,i(JSON.stringify(m.value,null,2)),1)]),j(W,{modelValue:r.value,"onUpdate:modelValue":_[0]||(_[0]=S=>r.value=S),label:"制作截图（可选）","aspect-hint":"自由比例"},null,8,["modelValue"]),t("div",Kt,[t("button",{class:"rounded-xl bg-amber-500 px-4 py-3 font-semibold text-white",onClick:g},"保存到历史制作记录"),o.value?(p(),x("p",Qt,"已保存，可在“我的 -> 历史制作记录”查看。")):G("",!0),t("button",{class:"rounded-xl border border-stone-300 px-4 py-3",onClick:k},"再做一单"),t("button",{class:"rounded-xl border border-stone-300 px-4 py-3",onClick:d},"完成并去我的")])]))}},Yt={class:"space-y-4"},Zt={class:"card p-3"},te={class:"grid grid-cols-5 gap-1 text-center text-[11px]"},ee={class:"card overflow-hidden"},se={class:"wizard-tail-bg p-4"},ne={class:"mb-2 flex items-center justify-between"},oe={class:"rounded-full bg-white/70 px-2 py-0.5 text-[10px] text-stone-600"},re={class:"h-2 overflow-hidden rounded-full bg-white/70"},ae={class:"mt-3 rounded-xl bg-white/75 px-3 py-2 text-xs leading-5 text-stone-600"},le={__name:"ProductionWizard",setup(C){const u=y(1),v={1:Z,2:lt,3:Nt,4:Ut,5:Xt},n=["水果安放","预处理","方案选择","制作监控","完成"],s=["请确保水果摆放稳定，避免加工时偏移。","切块为必选，去核和削皮可按水果类型选择。","先确认刀片状态，再设置温度/甜度等参数。","监控进度和预计时间，过程可实时查看。","完成后建议保存历史记录，便于复用方案。"],a=w(()=>v[u.value]),o=w(()=>s[u.value-1]||""),r=w(()=>Math.round(u.value/n.length*100));function f(){u.value<5&&(u.value+=1)}function m(){u.value>1&&(u.value-=1)}function g(){u.value=1}return(k,d)=>(p(),x("div",Yt,[t("div",Zt,[t("div",te,[(p(),x(T,null,V(n,(b,_)=>t("div",{key:b,class:$(["rounded-xl px-1 py-2",_+1<=u.value?"bg-amber-500 text-white":"bg-stone-100 text-stone-500"])},i(_+1)+"."+i(b),3)),64))])]),(p(),R(U(a.value),{onNext:f,onBack:m,onRestart:g},null,32)),t("section",ee,[t("div",se,[t("div",ne,[d[0]||(d[0]=t("h3",{class:"text-sm font-semibold text-stone-800"},"制作助手",-1)),t("span",oe,"阶段 "+i(u.value)+"/5",1)]),t("div",re,[t("div",{class:"h-full bg-gradient-to-r from-amber-500 to-emerald-400 transition-all duration-500",style:N({width:`${r.value}%`})},null,4)]),t("p",ae,i(o.value),1),d[1]||(d[1]=O('<div class="mt-3 grid grid-cols-3 gap-2" data-v-c10c1041><div class="rounded-xl bg-white/75 px-2 py-2 text-center" data-v-c10c1041><p class="text-[10px] text-stone-500" data-v-c10c1041>刀片状态</p><p class="mt-1 text-xs font-semibold text-emerald-600 pulse-text" data-v-c10c1041>正常</p></div><div class="rounded-xl bg-white/75 px-2 py-2 text-center" data-v-c10c1041><p class="text-[10px] text-stone-500" data-v-c10c1041>温控</p><p class="mt-1 text-xs font-semibold text-amber-600 pulse-text" data-v-c10c1041>稳定</p></div><div class="rounded-xl bg-white/75 px-2 py-2 text-center" data-v-c10c1041><p class="text-[10px] text-stone-500" data-v-c10c1041>建议</p><p class="mt-1 text-xs font-semibold text-cyan-600 pulse-text" data-v-c10c1041>低糖优先</p></div></div>',1))])])]))}},xe=L(le,[["__scopeId","data-v-c10c1041"]]);export{xe as default};
