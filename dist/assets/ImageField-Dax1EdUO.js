import{x as y,o as m,c as f,a as s,t as v,j as d,e as c,m as b,b as j,v as B,i as g,f as u}from"./index-DkfAZXiR.js";import{f as k,I as D,n as P,e as C}from"./ImageEditor-DJcDNQea.js";/**
 * @license lucide-vue-next v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=y("ImagePlusIcon",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-vue-next v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=y("LinkIcon",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-vue-next v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=y("PencilLineIcon",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}],["path",{d:"m15 5 3 3",key:"1w25hb"}]]),H={class:"rounded-2xl border border-stone-200 bg-white p-3"},N={class:"mb-2 flex items-center justify-between"},R={class:"text-sm font-medium text-stone-700"},W={class:"text-xs text-stone-400"},$={class:"flex gap-3"},q={class:"h-20 w-20 overflow-hidden rounded-xl bg-stone-100"},T=["src"],A={key:1,class:"flex h-full w-full items-center justify-center text-xs text-stone-400"},O={class:"flex-1 space-y-2"},Z={class:"flex cursor-pointer items-center gap-2 rounded-xl border border-dashed border-stone-300 px-3 py-2 text-xs text-stone-600"},G=["disabled"],J={class:"mt-3 flex gap-2"},K={class:"mt-2 text-xs text-stone-500"},Y={__name:"ImageField",props:{modelValue:{type:String,default:""},label:{type:String,default:"图片"},aspectHint:{type:String,default:"推荐 1:1"}},emits:["update:modelValue"],setup(n,{emit:_}){const w=n,h=_,r=u(!1),p=u(""),x=u(""),l=u(""),a=g(()=>P(w.modelValue)),I=g(()=>C(a.value));function V(e){return new Promise((t,o)=>{const i=new FileReader;i.onload=()=>t(String(i.result||"")),i.onerror=o,i.readAsDataURL(e)})}async function L(e){const[t]=e.target.files||[];t&&(p.value=await V(t),r.value=!0,e.target.value="")}function S(e){h("update:modelValue",e.image),e.strategy==="dataUrl"?l.value=`已保存为 DataURL（${k(e.size)}）`:l.value="已保存为网络链接"}function U(){const e=String(x.value||"").trim();if(!e.startsWith("http://")&&!e.startsWith("https://")){l.value="请输入有效图片链接";return}h("update:modelValue",e),l.value="已更新为网络图片"}function M(){a.value&&(p.value=a.value,r.value=!0)}return(e,t)=>(m(),f("div",H,[s("div",N,[s("label",R,v(n.label),1),s("span",W,v(n.aspectHint),1)]),s("div",$,[s("div",q,[a.value?(m(),f("img",{key:0,src:a.value,class:"h-full w-full object-cover"},null,8,T)):(m(),f("div",A,"无图"))]),s("div",O,[s("label",Z,[d(c(E),{class:"h-4 w-4"}),t[2]||(t[2]=b(" 选择并编辑 ",-1)),s("input",{type:"file",accept:"image/*",class:"hidden",onChange:L},null,32)]),s("button",{class:"flex w-full items-center gap-2 rounded-xl border border-stone-200 px-3 py-2 text-xs text-stone-600 disabled:opacity-40",disabled:!a.value,onClick:M},[d(c(z),{class:"h-4 w-4"}),t[3]||(t[3]=b(" 编辑或替换 ",-1))],8,G)])]),s("div",J,[j(s("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>x.value=o),type:"url",placeholder:"或粘贴网络图片链接",class:"flex-1 rounded-xl border border-stone-200 px-3 py-2 text-xs"},null,512),[[B,x.value]]),s("button",{class:"rounded-xl border border-amber-500 px-3 py-2 text-xs font-semibold text-amber-600",onClick:U},[d(c(F),{class:"mx-auto h-4 w-4"})])]),s("p",K,v(l.value||(a.value.startsWith("data:image")?`当前本地存储体积约 ${c(k)(I.value)}`:"当前使用网络链接存储")),1),d(D,{open:r.value,"onUpdate:open":t[1]||(t[1]=o=>r.value=o),src:p.value,title:`${n.label}编辑`,onSave:S},null,8,["open","src","title"])]))}};export{Y as _};
