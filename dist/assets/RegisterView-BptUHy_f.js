import{u as h,o as n,c as d,a as t,b as a,v as r,j as U,k as m,l as b,m as g,F as S,r as C,t as p,d as c,e as F,f as v,i as I,g as N}from"./index-CooPFdbs.js";import{_ as P}from"./ImageField-MwFkMJ5Y.js";import"./ImageEditor-62VxGMNA.js";const A={class:"min-h-screen bg-app-bg px-4 py-5"},B={class:"mx-auto max-w-md space-y-4"},M={class:"rounded-3xl border border-amber-100 bg-white p-5 shadow-lg"},T={class:"mt-4 space-y-3"},$={class:"grid grid-cols-2 gap-2"},D={class:"rounded-2xl border border-stone-200 p-3"},R={class:"mt-2 flex flex-wrap gap-3 text-sm"},j={class:"flex items-center gap-2"},E={class:"flex items-center gap-2"},L={class:"mt-2 flex gap-2"},_={class:"mt-2 flex flex-wrap gap-2"},q=["onClick"],z={key:0,class:"rounded-xl bg-red-50 px-3 py-2 text-xs text-red-500"},G={key:1,class:"rounded-xl bg-green-50 px-3 py-2 text-xs text-green-600"},H=["disabled"],X={__name:"RegisterView",setup(J){const x=N(),f=h(),e=v({account:"",password:"",confirmPassword:"",nickname:"",avatar:"",gender:"",birthday:"",region:"",role:"user",lowSugar:!1,highFiber:!1,allergyInput:"",allergies:[]}),u=v(""),i=v(""),y=I(()=>e.value.account&&e.value.password&&e.value.nickname&&e.value.avatar);function w(){const s=e.value.allergyInput.trim();s&&(e.value.allergies.includes(s)||e.value.allergies.push(s),e.value.allergyInput="")}function k(s){e.value.allergies=e.value.allergies.filter(l=>l!==s)}function V(){if(u.value="",i.value="",e.value.password!==e.value.confirmPassword){u.value="两次输入密码不一致";return}const s=f.register({account:e.value.account,password:e.value.password,nickname:e.value.nickname,avatar:e.value.avatar,gender:e.value.gender,birthday:e.value.birthday,region:e.value.region,role:e.value.role,preference:{lowSugar:e.value.lowSugar,highFiber:e.value.highFiber,allergies:e.value.allergies}});if(!s.success){u.value=s.message;return}i.value="注册成功，请登录",setTimeout(()=>{x.push("/login")},600)}return(s,l)=>(n(),d("div",A,[t("div",B,[t("div",M,[l[18]||(l[18]=t("h1",{class:"text-xl font-bold text-stone-800"},"注册账号",-1)),l[19]||(l[19]=t("p",{class:"mt-1 text-xs text-stone-500"},"纯前端演示：密码为简单 hash 存储，请勿用于真实生产。",-1)),t("div",T,[a(t("input",{"onUpdate:modelValue":l[0]||(l[0]=o=>e.value.account=o),type:"text",placeholder:"账号（必填）",class:"w-full rounded-xl border border-stone-200 px-3 py-2.5"},null,512),[[r,e.value.account]]),a(t("input",{"onUpdate:modelValue":l[1]||(l[1]=o=>e.value.password=o),type:"password",placeholder:"密码（必填）",class:"w-full rounded-xl border border-stone-200 px-3 py-2.5"},null,512),[[r,e.value.password]]),a(t("input",{"onUpdate:modelValue":l[2]||(l[2]=o=>e.value.confirmPassword=o),type:"password",placeholder:"确认密码",class:"w-full rounded-xl border border-stone-200 px-3 py-2.5"},null,512),[[r,e.value.confirmPassword]]),a(t("input",{"onUpdate:modelValue":l[3]||(l[3]=o=>e.value.nickname=o),type:"text",placeholder:"昵称（必填）",class:"w-full rounded-xl border border-stone-200 px-3 py-2.5"},null,512),[[r,e.value.nickname]]),U(P,{modelValue:e.value.avatar,"onUpdate:modelValue":l[4]||(l[4]=o=>e.value.avatar=o),label:"头像（必填）","aspect-hint":"建议 1:1"},null,8,["modelValue"]),t("div",$,[a(t("select",{"onUpdate:modelValue":l[5]||(l[5]=o=>e.value.gender=o),class:"rounded-xl border border-stone-200 px-3 py-2.5"},[...l[13]||(l[13]=[t("option",{value:""},"性别（可选）",-1),t("option",{value:"男"},"男",-1),t("option",{value:"女"},"女",-1),t("option",{value:"保密"},"保密",-1)])],512),[[m,e.value.gender]]),a(t("input",{"onUpdate:modelValue":l[6]||(l[6]=o=>e.value.birthday=o),type:"date",class:"rounded-xl border border-stone-200 px-3 py-2.5"},null,512),[[r,e.value.birthday]])]),a(t("input",{"onUpdate:modelValue":l[7]||(l[7]=o=>e.value.region=o),type:"text",placeholder:"地区（可选）",class:"w-full rounded-xl border border-stone-200 px-3 py-2.5"},null,512),[[r,e.value.region]]),a(t("select",{"onUpdate:modelValue":l[8]||(l[8]=o=>e.value.role=o),class:"w-full rounded-xl border border-stone-200 px-3 py-2.5"},[...l[14]||(l[14]=[t("option",{value:"user"},"普通用户",-1),t("option",{value:"maintainer"},"设备维护员",-1)])],512),[[m,e.value.role]]),t("div",D,[l[17]||(l[17]=t("p",{class:"text-sm font-medium text-stone-700"},"偏好设置",-1)),t("div",R,[t("label",j,[a(t("input",{"onUpdate:modelValue":l[9]||(l[9]=o=>e.value.lowSugar=o),type:"checkbox"},null,512),[[b,e.value.lowSugar]]),l[15]||(l[15]=g(" 低糖",-1))]),t("label",E,[a(t("input",{"onUpdate:modelValue":l[10]||(l[10]=o=>e.value.highFiber=o),type:"checkbox"},null,512),[[b,e.value.highFiber]]),l[16]||(l[16]=g(" 高纤维",-1))])]),t("div",L,[a(t("input",{"onUpdate:modelValue":l[11]||(l[11]=o=>e.value.allergyInput=o),type:"text",placeholder:"过敏源（自定义）",class:"flex-1 rounded-xl border border-stone-200 px-3 py-2 text-sm"},null,512),[[r,e.value.allergyInput]]),t("button",{class:"rounded-xl border border-amber-500 px-3 text-sm text-amber-600",onClick:w},"添加")]),t("div",_,[(n(!0),d(S,null,C(e.value.allergies,o=>(n(),d("button",{key:o,class:"rounded-full bg-amber-100 px-3 py-1 text-xs text-amber-700",onClick:K=>k(o)},p(o)+" × ",9,q))),128))])]),u.value?(n(),d("p",z,p(u.value),1)):c("",!0),i.value?(n(),d("p",G,p(i.value),1)):c("",!0),t("button",{class:"w-full rounded-xl bg-amber-500 px-4 py-3 font-semibold text-white disabled:opacity-60",disabled:!y.value,onClick:V}," 注册 ",8,H)])]),t("button",{class:"w-full rounded-xl border border-stone-300 bg-white px-4 py-2.5 text-sm",onClick:l[12]||(l[12]=o=>F(x).push("/login"))}," 已有账号，返回登录 ")])]))}};export{X as default};
