import{u as S,o as l,c as r,a as t,z as p,F as k,r as y,d as m,w as B,b as F,v as P,f as v,i as h,t as n,e as C}from"./index-DkfAZXiR.js";import{u as U}from"./community-BGzd6QHW.js";import{a as w}from"./datetime-DA9gX19a.js";const V={class:"space-y-4"},z={class:"card p-4"},M={class:"mt-2 flex gap-2 text-xs"},R={class:"mt-3 space-y-2"},T={class:"text-sm font-medium"},D={class:"mt-1 text-xs text-stone-500"},N={class:"mt-2 grid grid-cols-3 gap-2 text-xs"},E=["onClick"],L=["onClick"],j=["onClick"],q=["onClick"],G={key:0,class:"text-sm text-stone-400"},J={class:"card p-4"},K={class:"mt-2 flex gap-2 text-xs"},O={class:"mt-3 space-y-2"},Q={class:"text-sm font-medium"},W={class:"mt-1 text-xs text-stone-500"},X={class:"mt-1 text-xs text-stone-500"},Y={class:"mt-1 text-xs text-stone-400"},Z=["onClick"],ee={key:1,class:"mt-2 text-xs text-green-600"},te={key:0,class:"text-sm text-stone-400"},se={class:"mx-auto max-w-md rounded-3xl bg-white p-4"},oe={class:"mt-3 grid grid-cols-2 gap-2"},ae={__name:"CommunityManageView",setup(ne){const d=U(),b=S(),a=v("all"),i=v("pending"),c=v(""),u=v(""),f=h(()=>a.value==="pending"?d.posts.filter(o=>!o.isApproved):a.value==="hidden"?d.posts.filter(o=>o.isHidden):d.posts),_=h(()=>i.value==="all"?d.reports:d.reports.filter(o=>o.status===i.value));function $(o){var s;return((s=d.getPostById(o))==null?void 0:s.title)||"已删除帖子"}function g(o,s){d.moderatePost(o,s,b.currentUser)}function H(o){d.deletePost(o,b.currentUser)}function A(o){u.value=o,c.value=""}function I(){var o;u.value&&(d.handleReport({reportId:u.value,result:c.value||"已处理",handlerId:(o=b.currentUser)==null?void 0:o.id}),u.value="",c.value="")}return(o,s)=>(l(),r("div",V,[t("section",z,[s[9]||(s[9]=t("h2",{class:"text-lg font-semibold"},"帖子管理",-1)),t("div",M,[t("button",{class:p(["rounded-full px-3 py-1.5",a.value==="all"?"bg-amber-500 text-white":"bg-stone-100"]),onClick:s[0]||(s[0]=e=>a.value="all")},"全部",2),t("button",{class:p(["rounded-full px-3 py-1.5",a.value==="pending"?"bg-amber-500 text-white":"bg-stone-100"]),onClick:s[1]||(s[1]=e=>a.value="pending")},"待审核",2),t("button",{class:p(["rounded-full px-3 py-1.5",a.value==="hidden"?"bg-amber-500 text-white":"bg-stone-100"]),onClick:s[2]||(s[2]=e=>a.value="hidden")},"已隐藏",2)]),t("div",R,[(l(!0),r(k,null,y(f.value,e=>(l(),r("article",{key:e.id,class:"rounded-xl border border-stone-200 p-3"},[t("p",T,n(e.title),1),t("p",D,n(C(w)(e.createdAt))+" · "+n(e.isApproved?"已审核":"待审核")+" · "+n(e.isHidden?"隐藏":"展示"),1),t("div",N,[t("button",{class:"rounded-lg border border-stone-300 px-2 py-1",onClick:x=>g(e.id,"approve")},"通过",8,E),t("button",{class:"rounded-lg border border-stone-300 px-2 py-1",onClick:x=>g(e.id,e.isHidden?"show":"hide")},n(e.isHidden?"取消隐藏":"隐藏"),9,L),t("button",{class:"rounded-lg border border-stone-300 px-2 py-1",onClick:x=>g(e.id,"pin")},"置顶",8,j),t("button",{class:"col-span-3 rounded-lg border border-red-300 px-2 py-1 text-red-500",onClick:x=>H(e.id)},"删除",8,q)])]))),128)),f.value.length?m("",!0):(l(),r("p",G,"暂无帖子"))])]),t("section",J,[s[10]||(s[10]=t("h2",{class:"text-lg font-semibold"},"举报处理",-1)),t("div",K,[t("button",{class:p(["rounded-full px-3 py-1.5",i.value==="pending"?"bg-amber-500 text-white":"bg-stone-100"]),onClick:s[3]||(s[3]=e=>i.value="pending")},"待处理",2),t("button",{class:p(["rounded-full px-3 py-1.5",i.value==="resolved"?"bg-amber-500 text-white":"bg-stone-100"]),onClick:s[4]||(s[4]=e=>i.value="resolved")},"已处理",2),t("button",{class:p(["rounded-full px-3 py-1.5",i.value==="all"?"bg-amber-500 text-white":"bg-stone-100"]),onClick:s[5]||(s[5]=e=>i.value="all")},"全部",2)]),t("div",O,[(l(!0),r(k,null,y(_.value,e=>(l(),r("article",{key:e.id,class:"rounded-xl border border-stone-200 p-3"},[t("p",Q,n($(e.postId)),1),t("p",W,"原因："+n(e.reason)+" · 状态："+n(e.status==="pending"?"待处理":"已处理"),1),t("p",X,"描述："+n(e.description||"无"),1),t("p",Y,n(C(w)(e.createdAt)),1),e.status==="pending"?(l(),r("button",{key:0,class:"mt-2 rounded-lg border border-amber-400 px-3 py-1 text-xs text-amber-600",onClick:x=>A(e.id)}," 标记为已处理 ",8,Z)):(l(),r("p",ee,"处理结果："+n(e.result||"已处理"),1))]))),128)),_.value.length?m("",!0):(l(),r("p",te,"暂无举报数据"))])]),u.value?(l(),r("div",{key:0,class:"fixed inset-0 z-[65] bg-black/50 p-3",onClick:s[8]||(s[8]=B(e=>u.value="",["self"]))},[t("div",se,[s[11]||(s[11]=t("h3",{class:"text-lg font-semibold"},"处理举报",-1)),F(t("textarea",{"onUpdate:modelValue":s[6]||(s[6]=e=>c.value=e),rows:"3",placeholder:"请输入处理结果",class:"mt-3 w-full rounded-xl border border-stone-200 px-3 py-2"},null,512),[[P,c.value]]),t("div",oe,[t("button",{class:"rounded-xl border border-stone-300 px-3 py-2",onClick:s[7]||(s[7]=e=>u.value="")},"取消"),t("button",{class:"rounded-xl bg-amber-500 px-3 py-2 font-semibold text-white",onClick:I},"确认处理")])])])):m("",!0)]))}};export{ae as default};
