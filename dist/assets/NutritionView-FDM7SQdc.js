import{u as M,o as u,c as d,a as r,b as s,v as a,d as c,F as U,r as G,w as N,t as b,j as $,f as v,i as y,g as I,e as S}from"./index-CooPFdbs.js";import{u as j}from"./nutrition-B9tmYJIo.js";import{_ as B}from"./ImageField-MwFkMJ5Y.js";import"./ImageEditor-62VxGMNA.js";const E={class:"space-y-4"},L={class:"card p-4"},A={class:"grid grid-cols-1 gap-3"},D=["src"],F={class:"space-y-2 p-4"},z={class:"text-base font-semibold"},R={class:"line-clamp-2 text-sm text-stone-600"},T={class:"flex gap-2"},q=["onClick"],H=["onClick"],J=["onClick"],K={class:"mx-auto max-h-full max-w-xl space-y-3 overflow-y-auto rounded-3xl bg-white p-4"},O={class:"text-lg font-semibold"},P={class:"grid grid-cols-2 gap-2"},Q={class:"grid grid-cols-2 gap-2"},te={__name:"NutritionView",setup(W){const g=I(),p=j(),w=M(),m=v(""),n=v(!1),i=v(""),t=v({title:"",summary:"",cover:"",detail:"",fruits:"",waterMl:0,sugarG:0,temperature:""}),x=y(()=>w.role==="admin"),k=y(()=>{const o=m.value.trim().toLowerCase();return p.sortedItems.filter(l=>o?[l.title,l.summary,l.detail].join(" ").toLowerCase().includes(o):!0)});function _(){i.value="",t.value={title:"",summary:"",cover:"",detail:"",fruits:"",waterMl:0,sugarG:0,temperature:""},n.value=!0}function h(o){i.value=o.id,t.value={title:o.title,summary:o.summary,cover:o.cover,detail:o.detail,fruits:o.recipe.fruits,waterMl:o.recipe.waterMl,sugarG:o.recipe.sugarG,temperature:o.recipe.temperature},n.value=!0}function V(){const o={title:t.value.title,summary:t.value.summary,cover:t.value.cover,detail:t.value.detail,recipe:{fruits:t.value.fruits,waterMl:Number(t.value.waterMl),sugarG:Number(t.value.sugarG),temperature:t.value.temperature}};i.value?p.updateItem(i.value,o):p.createItem(o),n.value=!1}function C(o){p.deleteItem(o)}return(o,l)=>(u(),d("div",E,[r("section",L,[s(r("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>m.value=e),type:"text",placeholder:"搜索标题/内容",class:"w-full rounded-xl border border-stone-200 px-3 py-2.5"},null,512),[[a,m.value]]),x.value?(u(),d("button",{key:0,class:"mt-3 w-full rounded-xl bg-amber-500 px-4 py-2.5 text-sm font-semibold text-white",onClick:_}," 新增科普内容 ")):c("",!0)]),r("section",A,[(u(!0),d(U,null,G(k.value,e=>(u(),d("article",{key:e.id,class:"card overflow-hidden"},[r("img",{src:e.cover,class:"h-40 w-full object-cover"},null,8,D),r("div",F,[r("h3",z,b(e.title),1),r("p",R,b(e.summary),1),r("div",T,[r("button",{class:"rounded-xl border border-stone-300 px-3 py-2 text-xs",onClick:f=>S(g).push(`/nutrition/${e.id}`)},"查看详情",8,q),x.value?(u(),d("button",{key:0,class:"rounded-xl border border-amber-400 px-3 py-2 text-xs text-amber-600",onClick:f=>h(e)},"编辑",8,H)):c("",!0),x.value?(u(),d("button",{key:1,class:"rounded-xl border border-red-300 px-3 py-2 text-xs text-red-500",onClick:f=>C(e.id)},"删除",8,J)):c("",!0)])])]))),128))]),n.value?(u(),d("div",{key:0,class:"fixed inset-0 z-[65] bg-black/50 p-3",onClick:l[10]||(l[10]=N(e=>n.value=!1,["self"]))},[r("div",K,[r("h3",O,b(i.value?"编辑科普":"新增科普"),1),s(r("input",{"onUpdate:modelValue":l[1]||(l[1]=e=>t.value.title=e),type:"text",placeholder:"标题",class:"w-full rounded-xl border border-stone-200 px-3 py-2"},null,512),[[a,t.value.title]]),s(r("input",{"onUpdate:modelValue":l[2]||(l[2]=e=>t.value.summary=e),type:"text",placeholder:"简介",class:"w-full rounded-xl border border-stone-200 px-3 py-2"},null,512),[[a,t.value.summary]]),$(B,{modelValue:t.value.cover,"onUpdate:modelValue":l[3]||(l[3]=e=>t.value.cover=e),label:"封面图","aspect-hint":"建议 16:9"},null,8,["modelValue"]),s(r("textarea",{"onUpdate:modelValue":l[4]||(l[4]=e=>t.value.detail=e),rows:"4",placeholder:"详情介绍",class:"w-full rounded-xl border border-stone-200 px-3 py-2"},null,512),[[a,t.value.detail]]),r("div",P,[s(r("input",{"onUpdate:modelValue":l[5]||(l[5]=e=>t.value.fruits=e),type:"text",placeholder:"水果配比",class:"rounded-xl border border-stone-200 px-3 py-2"},null,512),[[a,t.value.fruits]]),s(r("input",{"onUpdate:modelValue":l[6]||(l[6]=e=>t.value.temperature=e),type:"text",placeholder:"饮用温度",class:"rounded-xl border border-stone-200 px-3 py-2"},null,512),[[a,t.value.temperature]]),s(r("input",{"onUpdate:modelValue":l[7]||(l[7]=e=>t.value.waterMl=e),type:"number",placeholder:"注水量 ml",class:"rounded-xl border border-stone-200 px-3 py-2"},null,512),[[a,t.value.waterMl]]),s(r("input",{"onUpdate:modelValue":l[8]||(l[8]=e=>t.value.sugarG=e),type:"number",placeholder:"糖量 g",class:"rounded-xl border border-stone-200 px-3 py-2"},null,512),[[a,t.value.sugarG]])]),r("div",Q,[r("button",{class:"rounded-xl border border-stone-300 px-4 py-2.5",onClick:l[9]||(l[9]=e=>n.value=!1)},"取消"),r("button",{class:"rounded-xl bg-amber-500 px-4 py-2.5 font-semibold text-white",onClick:V},"保存")])])])):c("",!0)]))}};export{te as default};
