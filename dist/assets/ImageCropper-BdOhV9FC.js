import{i as x,D as E,f as C,c as H,a as o,b as g,l as m,z as I,k as O,q as F,s as G,v as J,j as u}from"./index-DxTQJ_MY.js";import{X as K}from"./x-DZX_Ph0D.js";import{C as Q}from"./check-DKu3InlJ.js";/**
 * @license lucide-vue-next v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=x("HeartIcon",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-vue-next v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=x("SquarePenIcon",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-vue-next v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=x("ZoomInIcon",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-vue-next v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=x("ZoomOutIcon",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),oe={class:"fixed inset-0 z-50 bg-black/90 flex flex-col items-center justify-center p-4"},se={class:"w-full max-w-lg bg-gray-900 rounded-3xl overflow-hidden shadow-2xl flex flex-col h-[80vh]"},ne={class:"p-4 flex justify-between items-center text-white"},ce={class:"absolute inset-0 flex items-center justify-center pointer-events-none"},ae=["src"],ie={class:"absolute inset-0 pointer-events-none flex items-center justify-center"},re={class:"absolute inset-0 pointer-events-none flex items-center justify-center opacity-30"},le={key:0,class:"border border-white/50 w-[80%] aspect-square grid grid-cols-3 grid-rows-3"},de={class:"p-6 bg-gray-800 space-y-4"},ue={class:"flex items-center gap-4 text-white"},ye={__name:"ImageCropper",props:{imageSrc:String,aspectRatio:{type:Number,default:1}},emits:["confirm","cancel"],setup(i,{emit:S}){const d=i,X=S,k=u(null),r=u(1),c=u({x:0,y:0}),y=u(!1),h=u({x:0,y:0});E(()=>d.imageSrc,()=>{r.value=1,c.value={x:0,y:0}});const R=e=>{y.value=!0,h.value={x:e.touches?e.touches[0].clientX:e.clientX,y:e.touches?e.touches[0].clientY:e.clientY}},_=e=>{if(!y.value)return;e.preventDefault();const s=e.touches?e.touches[0].clientX:e.clientX,n=e.touches?e.touches[0].clientY:e.clientY,t=s-h.value.x,a=n-h.value.y;c.value={x:c.value.x+t,y:c.value.y+a},h.value={x:s,y:n}},p=()=>{y.value=!1},Y=()=>{const e=document.createElement("canvas"),s=e.getContext("2d"),n=new Image;n.onload=()=>{const t=k.value.getBoundingClientRect();let a,l;d.aspectRatio>=1?(a=t.width*.8,l=a/d.aspectRatio):(l=t.height*.6,a=l*d.aspectRatio);const b=n.naturalWidth/n.naturalHeight,B=t.width/t.height;let f,w;b>B?(f=t.width,w=t.width/b):(w=t.height,f=t.height*b);const j=f*r.value,D=w*r.value,M=t.width/2+c.value.x,W=t.height/2+c.value.y,T=M-j/2,Z=W-D/2,L=(t.width-a)/2,N=(t.height-l)/2,V=L-T,$=N-Z,v=n.naturalWidth/j,q=V*v,A=$*v,z=a*v,P=l*v;e.width=a,e.height=l,s.drawImage(n,q,A,z,P,0,0,e.width,e.height);const U=e.toDataURL("image/jpeg",.9);X("confirm",U)},n.src=d.imageSrc};return(e,s)=>(C(),H("div",oe,[o("div",se,[o("div",ne,[o("button",{onClick:s[0]||(s[0]=n=>e.$emit("cancel")),class:"p-2 hover:bg-white/10 rounded-full"},[g(m(K),{class:"w-6 h-6"})]),s[2]||(s[2]=o("span",{class:"font-bold"},"调整图片",-1)),o("button",{onClick:Y,class:"p-2 hover:bg-green-500/20 text-green-400 rounded-full"},[g(m(Q),{class:"w-6 h-6"})])]),o("div",{ref_key:"containerRef",ref:k,class:"flex-1 bg-black relative overflow-hidden touch-none",onMousedown:R,onMousemove:_,onMouseup:p,onMouseleave:p,onTouchstart:R,onTouchmove:_,onTouchend:p},[o("div",ce,[o("img",{src:i.imageSrc,style:I({transform:`translate(${c.value.x}px, ${c.value.y}px) scale(${r.value})`,maxWidth:"none",maxHeight:"none"}),class:"h-full object-contain opacity-80"},null,12,ae)]),o("div",ie,[o("div",{class:"border-2 border-white shadow-[0_0_0_9999px_rgba(0,0,0,0.7)]",style:I({aspectRatio:i.aspectRatio,width:i.aspectRatio>=1?"80%":"auto",height:i.aspectRatio<1?"60%":"auto"})},null,4)]),o("div",re,[i.aspectRatio===1?(C(),H("div",le,[...s[3]||(s[3]=[O('<div class="border-r border-b border-white/50"></div><div class="border-r border-b border-white/50"></div><div class="border-b border-white/50"></div><div class="border-r border-b border-white/50"></div><div class="border-r border-b border-white/50"></div><div class="border-b border-white/50"></div><div class="border-r border-white/50"></div><div class="border-r border-white/50"></div><div></div>',9)])])):F("",!0)])],544),o("div",de,[o("div",ue,[g(m(te),{class:"w-5 h-5 text-gray-400"}),G(o("input",{type:"range","onUpdate:modelValue":s[1]||(s[1]=n=>r.value=n),min:"0.5",max:"3",step:"0.1",class:"flex-1 h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer accent-fresh-green-500"},null,512),[[J,r.value]]),g(m(ee),{class:"w-5 h-5 text-gray-400"})])])])]))}};export{me as H,xe as S,ye as _};
